// Compiled by ClojureScript 1.10.879 {:optimizations :none}
goog.provide('compound2.core');
goog.require('cljs.core');

/**
 * @interface
 */
compound2.core.Index = function(){};

var compound2$core$Index$id$dyn_20728 = (function (this$){
var x__4509__auto__ = (((this$ == null))?null:this$);
var m__4510__auto__ = (compound2.core.id[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,this$);
} else {
var m__4508__auto__ = (compound2.core.id["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,this$);
} else {
throw cljs.core.missing_protocol.call(null,"Index.id",this$);
}
}
});
compound2.core.id = (function compound2$core$id(this$){
if((((!((this$ == null)))) && ((!((this$.compound2$core$Index$id$arity$1 == null)))))){
return this$.compound2$core$Index$id$arity$1(this$);
} else {
return compound2$core$Index$id$dyn_20728.call(null,this$);
}
});

var compound2$core$Index$extract_key$dyn_20729 = (function (this$,x){
var x__4509__auto__ = (((this$ == null))?null:this$);
var m__4510__auto__ = (compound2.core.extract_key[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,this$,x);
} else {
var m__4508__auto__ = (compound2.core.extract_key["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,this$,x);
} else {
throw cljs.core.missing_protocol.call(null,"Index.extract-key",this$);
}
}
});
compound2.core.extract_key = (function compound2$core$extract_key(this$,x){
if((((!((this$ == null)))) && ((!((this$.compound2$core$Index$extract_key$arity$2 == null)))))){
return this$.compound2$core$Index$extract_key$arity$2(this$,x);
} else {
return compound2$core$Index$extract_key$dyn_20729.call(null,this$,x);
}
});

var compound2$core$Index$index$dyn_20730 = (function (this$,coll,k,x){
var x__4509__auto__ = (((this$ == null))?null:this$);
var m__4510__auto__ = (compound2.core.index[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,this$,coll,k,x);
} else {
var m__4508__auto__ = (compound2.core.index["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,this$,coll,k,x);
} else {
throw cljs.core.missing_protocol.call(null,"Index.index",this$);
}
}
});
compound2.core.index = (function compound2$core$index(this$,coll,k,x){
if((((!((this$ == null)))) && ((!((this$.compound2$core$Index$index$arity$4 == null)))))){
return this$.compound2$core$Index$index$arity$4(this$,coll,k,x);
} else {
return compound2$core$Index$index$dyn_20730.call(null,this$,coll,k,x);
}
});

var compound2$core$Index$unindex$dyn_20731 = (function (this$,coll,k,x){
var x__4509__auto__ = (((this$ == null))?null:this$);
var m__4510__auto__ = (compound2.core.unindex[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,this$,coll,k,x);
} else {
var m__4508__auto__ = (compound2.core.unindex["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,this$,coll,k,x);
} else {
throw cljs.core.missing_protocol.call(null,"Index.unindex",this$);
}
}
});
compound2.core.unindex = (function compound2$core$unindex(this$,coll,k,x){
if((((!((this$ == null)))) && ((!((this$.compound2$core$Index$unindex$arity$4 == null)))))){
return this$.compound2$core$Index$unindex$arity$4(this$,coll,k,x);
} else {
return compound2$core$Index$unindex$dyn_20731.call(null,this$,coll,k,x);
}
});

var compound2$core$Index$before$dyn_20732 = (function (this$,coll){
var x__4509__auto__ = (((this$ == null))?null:this$);
var m__4510__auto__ = (compound2.core.before[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,this$,coll);
} else {
var m__4508__auto__ = (compound2.core.before["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,this$,coll);
} else {
throw cljs.core.missing_protocol.call(null,"Index.before",this$);
}
}
});
compound2.core.before = (function compound2$core$before(this$,coll){
if((((!((this$ == null)))) && ((!((this$.compound2$core$Index$before$arity$2 == null)))))){
return this$.compound2$core$Index$before$arity$2(this$,coll);
} else {
return compound2$core$Index$before$dyn_20732.call(null,this$,coll);
}
});

var compound2$core$Index$after$dyn_20733 = (function (this$,coll){
var x__4509__auto__ = (((this$ == null))?null:this$);
var m__4510__auto__ = (compound2.core.after[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,this$,coll);
} else {
var m__4508__auto__ = (compound2.core.after["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,this$,coll);
} else {
throw cljs.core.missing_protocol.call(null,"Index.after",this$);
}
}
});
compound2.core.after = (function compound2$core$after(this$,coll){
if((((!((this$ == null)))) && ((!((this$.compound2$core$Index$after$arity$2 == null)))))){
return this$.compound2$core$Index$after$arity$2(this$,coll);
} else {
return compound2$core$Index$after$dyn_20733.call(null,this$,coll);
}
});


/**
 * @interface
 */
compound2.core.PrimaryIndex = function(){};

var compound2$core$PrimaryIndex$get_by_key$dyn_20734 = (function (this$,coll,k){
var x__4509__auto__ = (((this$ == null))?null:this$);
var m__4510__auto__ = (compound2.core.get_by_key[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,this$,coll,k);
} else {
var m__4508__auto__ = (compound2.core.get_by_key["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,this$,coll,k);
} else {
throw cljs.core.missing_protocol.call(null,"PrimaryIndex.get-by-key",this$);
}
}
});
compound2.core.get_by_key = (function compound2$core$get_by_key(this$,coll,k){
if((((!((this$ == null)))) && ((!((this$.compound2$core$PrimaryIndex$get_by_key$arity$3 == null)))))){
return this$.compound2$core$PrimaryIndex$get_by_key$arity$3(this$,coll,k);
} else {
return compound2$core$PrimaryIndex$get_by_key$dyn_20734.call(null,this$,coll,k);
}
});

var compound2$core$PrimaryIndex$get_all$dyn_20735 = (function (this$,coll){
var x__4509__auto__ = (((this$ == null))?null:this$);
var m__4510__auto__ = (compound2.core.get_all[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,this$,coll);
} else {
var m__4508__auto__ = (compound2.core.get_all["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,this$,coll);
} else {
throw cljs.core.missing_protocol.call(null,"PrimaryIndex.get-all",this$);
}
}
});
compound2.core.get_all = (function compound2$core$get_all(this$,coll){
if((((!((this$ == null)))) && ((!((this$.compound2$core$PrimaryIndex$get_all$arity$2 == null)))))){
return this$.compound2$core$PrimaryIndex$get_all$arity$2(this$,coll);
} else {
return compound2$core$PrimaryIndex$get_all$dyn_20735.call(null,this$,coll);
}
});

var compound2$core$PrimaryIndex$on_conflict$dyn_20736 = (function (this$,old,new$){
var x__4509__auto__ = (((this$ == null))?null:this$);
var m__4510__auto__ = (compound2.core.on_conflict[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,this$,old,new$);
} else {
var m__4508__auto__ = (compound2.core.on_conflict["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,this$,old,new$);
} else {
throw cljs.core.missing_protocol.call(null,"PrimaryIndex.on-conflict",this$);
}
}
});
compound2.core.on_conflict = (function compound2$core$on_conflict(this$,old,new$){
if((((!((this$ == null)))) && ((!((this$.compound2$core$PrimaryIndex$on_conflict$arity$3 == null)))))){
return this$.compound2$core$PrimaryIndex$on_conflict$arity$3(this$,old,new$);
} else {
return compound2$core$PrimaryIndex$on_conflict$dyn_20736.call(null,this$,old,new$);
}
});


/**
 * @interface
 */
compound2.core.Compound = function(){};

var compound2$core$Compound$items$dyn_20737 = (function (c){
var x__4509__auto__ = (((c == null))?null:c);
var m__4510__auto__ = (compound2.core.items[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,c);
} else {
var m__4508__auto__ = (compound2.core.items["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,c);
} else {
throw cljs.core.missing_protocol.call(null,"Compound.items",c);
}
}
});
compound2.core.items = (function compound2$core$items(c){
var temp__5751__auto__ = cljs.core.get.call(null,cljs.core.meta.call(null,c),cljs.core.with_meta(new cljs.core.Symbol("compound2.core","items","compound2.core/items",493606175,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("cljs.analyzer","no-resolve","cljs.analyzer/no-resolve",-1872351017),true], null)));
if(temp__5751__auto__){
var meta_impl__4511__auto__ = temp__5751__auto__;
return meta_impl__4511__auto__.call(null,c);
} else {
if((((!((c == null)))) && ((!((c.compound2$core$Compound$items$arity$1 == null)))))){
return c.compound2$core$Compound$items$arity$1(c);
} else {
return compound2$core$Compound$items$dyn_20737.call(null,c);
}
}
});

var compound2$core$Compound$add_items$dyn_20738 = (function (c,xs){
var x__4509__auto__ = (((c == null))?null:c);
var m__4510__auto__ = (compound2.core.add_items[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,c,xs);
} else {
var m__4508__auto__ = (compound2.core.add_items["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,c,xs);
} else {
throw cljs.core.missing_protocol.call(null,"Compound.add-items",c);
}
}
});
compound2.core.add_items = (function compound2$core$add_items(c,xs){
var temp__5751__auto__ = cljs.core.get.call(null,cljs.core.meta.call(null,c),cljs.core.with_meta(new cljs.core.Symbol("compound2.core","add-items","compound2.core/add-items",-1582321840,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("cljs.analyzer","no-resolve","cljs.analyzer/no-resolve",-1872351017),true], null)));
if(temp__5751__auto__){
var meta_impl__4511__auto__ = temp__5751__auto__;
return meta_impl__4511__auto__.call(null,c,xs);
} else {
if((((!((c == null)))) && ((!((c.compound2$core$Compound$add_items$arity$2 == null)))))){
return c.compound2$core$Compound$add_items$arity$2(c,xs);
} else {
return compound2$core$Compound$add_items$dyn_20738.call(null,c,xs);
}
}
});

var compound2$core$Compound$remove_keys$dyn_20739 = (function (c,ks){
var x__4509__auto__ = (((c == null))?null:c);
var m__4510__auto__ = (compound2.core.remove_keys[goog.typeOf(x__4509__auto__)]);
if((!((m__4510__auto__ == null)))){
return m__4510__auto__.call(null,c,ks);
} else {
var m__4508__auto__ = (compound2.core.remove_keys["_"]);
if((!((m__4508__auto__ == null)))){
return m__4508__auto__.call(null,c,ks);
} else {
throw cljs.core.missing_protocol.call(null,"Compound.remove-keys",c);
}
}
});
compound2.core.remove_keys = (function compound2$core$remove_keys(c,ks){
var temp__5751__auto__ = cljs.core.get.call(null,cljs.core.meta.call(null,c),cljs.core.with_meta(new cljs.core.Symbol("compound2.core","remove-keys","compound2.core/remove-keys",-384447827,null),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword("cljs.analyzer","no-resolve","cljs.analyzer/no-resolve",-1872351017),true], null)));
if(temp__5751__auto__){
var meta_impl__4511__auto__ = temp__5751__auto__;
return meta_impl__4511__auto__.call(null,c,ks);
} else {
if((((!((c == null)))) && ((!((c.compound2$core$Compound$remove_keys$arity$2 == null)))))){
return c.compound2$core$Compound$remove_keys$arity$2(c,ks);
} else {
return compound2$core$Compound$remove_keys$dyn_20739.call(null,c,ks);
}
}
});

if((typeof compound2 !== 'undefined') && (typeof compound2.core !== 'undefined') && (typeof compound2.core.indexer !== 'undefined')){
} else {
compound2.core.indexer = (function (){var method_table__4701__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
var prefer_table__4702__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
var method_cache__4703__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
var cached_hierarchy__4704__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);
var hierarchy__4705__auto__ = cljs.core.get.call(null,cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword(null,"hierarchy","hierarchy",-1053470341),cljs.core.get_global_hierarchy.call(null));
return (new cljs.core.MultiFn(cljs.core.symbol.call(null,"compound2.core","indexer"),new cljs.core.Keyword(null,"index-type","index-type",500383962),new cljs.core.Keyword(null,"default","default",-1987822328),hierarchy__4705__auto__,method_table__4701__auto__,prefer_table__4702__auto__,method_cache__4703__auto__,cached_hierarchy__4704__auto__));
})();
}
cljs.core._add_method.call(null,compound2.core.indexer,new cljs.core.Keyword(null,"one-to-one","one-to-one",-984522312),(function (opts){
var map__20740 = opts;
var map__20740__$1 = cljs.core.__destructure_map.call(null,map__20740);
var id = cljs.core.get.call(null,map__20740__$1,new cljs.core.Keyword(null,"id","id",-1388402092));
var kfn = cljs.core.get.call(null,map__20740__$1,new cljs.core.Keyword(null,"kfn","kfn",-911220526));
var on_conflict = cljs.core.get.call(null,map__20740__$1,new cljs.core.Keyword(null,"on-conflict","on-conflict",1595391642));
var id__$1 = (function (){var or__4212__auto__ = id;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
if((kfn instanceof cljs.core.Keyword)){
return kfn;
} else {
return null;
}
}
})();
var on_conflict__$1 = (function (){var or__4212__auto__ = on_conflict;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
return (function (_,new$){
return new$;
});
}
})();
if((!((id__$1 == null)))){
} else {
throw (new Error(["Assert failed: ","Must provide an id","\n","(some? id)"].join('')));
}

if((typeof compound2 !== 'undefined') && (typeof compound2.core !== 'undefined') && (typeof compound2.core.t_compound2$core20741 !== 'undefined')){
} else {

/**
* @constructor
 * @implements {compound2.core.PrimaryIndex}
 * @implements {cljs.core.IMeta}
 * @implements {compound2.core.Index}
 * @implements {cljs.core.IWithMeta}
*/
compound2.core.t_compound2$core20741 = (function (opts,map__20740,id,kfn,on_conflict,meta20742){
this.opts = opts;
this.map__20740 = map__20740;
this.id = id;
this.kfn = kfn;
this.on_conflict = on_conflict;
this.meta20742 = meta20742;
this.cljs$lang$protocol_mask$partition0$ = 393216;
this.cljs$lang$protocol_mask$partition1$ = 0;
});
(compound2.core.t_compound2$core20741.prototype.cljs$core$IWithMeta$_with_meta$arity$2 = (function (_20743,meta20742__$1){
var self__ = this;
var _20743__$1 = this;
return (new compound2.core.t_compound2$core20741(self__.opts,self__.map__20740,self__.id,self__.kfn,self__.on_conflict,meta20742__$1));
}));

(compound2.core.t_compound2$core20741.prototype.cljs$core$IMeta$_meta$arity$1 = (function (_20743){
var self__ = this;
var _20743__$1 = this;
return self__.meta20742;
}));

(compound2.core.t_compound2$core20741.prototype.compound2$core$PrimaryIndex$ = cljs.core.PROTOCOL_SENTINEL);

(compound2.core.t_compound2$core20741.prototype.compound2$core$PrimaryIndex$get_by_key$arity$3 = (function (this$,coll,k){
var self__ = this;
var this$__$1 = this;
return cljs.core.get.call(null,coll,k);
}));

(compound2.core.t_compound2$core20741.prototype.compound2$core$PrimaryIndex$get_all$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
return cljs.core.vals.call(null,coll);
}));

(compound2.core.t_compound2$core20741.prototype.compound2$core$PrimaryIndex$on_conflict$arity$3 = (function (this$,old,new$){
var self__ = this;
var this$__$1 = this;
return self__.on_conflict.call(null,old,new$);
}));

(compound2.core.t_compound2$core20741.prototype.compound2$core$Index$ = cljs.core.PROTOCOL_SENTINEL);

(compound2.core.t_compound2$core20741.prototype.compound2$core$Index$id$arity$1 = (function (this$){
var self__ = this;
var this$__$1 = this;
return self__.id;
}));

(compound2.core.t_compound2$core20741.prototype.compound2$core$Index$extract_key$arity$2 = (function (this$,x){
var self__ = this;
var this$__$1 = this;
return self__.kfn.call(null,x);
}));

(compound2.core.t_compound2$core20741.prototype.compound2$core$Index$index$arity$4 = (function (this$,coll,k,x){
var self__ = this;
var this$__$1 = this;
return cljs.core.assoc_BANG_.call(null,coll,k,x);
}));

(compound2.core.t_compound2$core20741.prototype.compound2$core$Index$unindex$arity$4 = (function (this$,coll,k,x){
var self__ = this;
var this$__$1 = this;
return cljs.core.dissoc_BANG_.call(null,coll,k);
}));

(compound2.core.t_compound2$core20741.prototype.compound2$core$Index$after$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
return cljs.core.persistent_BANG_.call(null,coll);
}));

(compound2.core.t_compound2$core20741.prototype.compound2$core$Index$before$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
return cljs.core.transient$.call(null,(function (){var or__4212__auto__ = coll;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
return cljs.core.PersistentArrayMap.EMPTY;
}
})());
}));

(compound2.core.t_compound2$core20741.getBasis = (function (){
return new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"opts","opts",1795607228,null),new cljs.core.Symbol(null,"map__20740","map__20740",838073563,null),new cljs.core.Symbol(null,"id","id",252129435,null),new cljs.core.Symbol(null,"kfn","kfn",729311001,null),new cljs.core.Symbol(null,"on-conflict","on-conflict",-1059044127,null),new cljs.core.Symbol(null,"meta20742","meta20742",1880031389,null)], null);
}));

(compound2.core.t_compound2$core20741.cljs$lang$type = true);

(compound2.core.t_compound2$core20741.cljs$lang$ctorStr = "compound2.core/t_compound2$core20741");

(compound2.core.t_compound2$core20741.cljs$lang$ctorPrWriter = (function (this__4450__auto__,writer__4451__auto__,opt__4452__auto__){
return cljs.core._write.call(null,writer__4451__auto__,"compound2.core/t_compound2$core20741");
}));

/**
 * Positional factory function for compound2.core/t_compound2$core20741.
 */
compound2.core.__GT_t_compound2$core20741 = (function compound2$core$__GT_t_compound2$core20741(opts__$1,map__20740__$2,id__$2,kfn__$1,on_conflict__$2,meta20742){
return (new compound2.core.t_compound2$core20741(opts__$1,map__20740__$2,id__$2,kfn__$1,on_conflict__$2,meta20742));
});

}

return (new compound2.core.t_compound2$core20741(opts,map__20740__$1,id__$1,kfn,on_conflict__$1,cljs.core.PersistentArrayMap.EMPTY));
}));
cljs.core._add_method.call(null,compound2.core.indexer,new cljs.core.Keyword(null,"one-to-many","one-to-many",-524686670),(function (opts){
var map__20744 = opts;
var map__20744__$1 = cljs.core.__destructure_map.call(null,map__20744);
var id = cljs.core.get.call(null,map__20744__$1,new cljs.core.Keyword(null,"id","id",-1388402092));
var kfn = cljs.core.get.call(null,map__20744__$1,new cljs.core.Keyword(null,"kfn","kfn",-911220526));
var id__$1 = (function (){var or__4212__auto__ = id;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
if((kfn instanceof cljs.core.Keyword)){
return kfn;
} else {
return null;
}
}
})();
if((!((id__$1 == null)))){
} else {
throw (new Error(["Assert failed: ","Must provide an id","\n","(some? id)"].join('')));
}

if((typeof compound2 !== 'undefined') && (typeof compound2.core !== 'undefined') && (typeof compound2.core.t_compound2$core20745 !== 'undefined')){
} else {

/**
* @constructor
 * @implements {cljs.core.IMeta}
 * @implements {compound2.core.Index}
 * @implements {cljs.core.IWithMeta}
*/
compound2.core.t_compound2$core20745 = (function (opts,map__20744,id,kfn,meta20746){
this.opts = opts;
this.map__20744 = map__20744;
this.id = id;
this.kfn = kfn;
this.meta20746 = meta20746;
this.cljs$lang$protocol_mask$partition0$ = 393216;
this.cljs$lang$protocol_mask$partition1$ = 0;
});
(compound2.core.t_compound2$core20745.prototype.cljs$core$IWithMeta$_with_meta$arity$2 = (function (_20747,meta20746__$1){
var self__ = this;
var _20747__$1 = this;
return (new compound2.core.t_compound2$core20745(self__.opts,self__.map__20744,self__.id,self__.kfn,meta20746__$1));
}));

(compound2.core.t_compound2$core20745.prototype.cljs$core$IMeta$_meta$arity$1 = (function (_20747){
var self__ = this;
var _20747__$1 = this;
return self__.meta20746;
}));

(compound2.core.t_compound2$core20745.prototype.compound2$core$Index$ = cljs.core.PROTOCOL_SENTINEL);

(compound2.core.t_compound2$core20745.prototype.compound2$core$Index$id$arity$1 = (function (this$){
var self__ = this;
var this$__$1 = this;
return self__.id;
}));

(compound2.core.t_compound2$core20745.prototype.compound2$core$Index$extract_key$arity$2 = (function (this$,x){
var self__ = this;
var this$__$1 = this;
return self__.kfn.call(null,x);
}));

(compound2.core.t_compound2$core20745.prototype.compound2$core$Index$index$arity$4 = (function (this$,coll,k,x){
var self__ = this;
var this$__$1 = this;
var ex = cljs.core.get.call(null,coll,k);
return cljs.core.assoc_BANG_.call(null,coll,k,cljs.core.conj.call(null,(function (){var or__4212__auto__ = ex;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
return cljs.core.PersistentHashSet.EMPTY;
}
})(),x));
}));

(compound2.core.t_compound2$core20745.prototype.compound2$core$Index$unindex$arity$4 = (function (this$,coll,k,x){
var self__ = this;
var this$__$1 = this;
var ex = cljs.core.get.call(null,coll,k);
var new$ = cljs.core.disj.call(null,ex,x);
if(cljs.core.seq.call(null,new$)){
return cljs.core.assoc_BANG_.call(null,coll,k,new$);
} else {
return cljs.core.dissoc_BANG_.call(null,coll,k);
}
}));

(compound2.core.t_compound2$core20745.prototype.compound2$core$Index$after$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
return cljs.core.persistent_BANG_.call(null,coll);
}));

(compound2.core.t_compound2$core20745.prototype.compound2$core$Index$before$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
return cljs.core.transient$.call(null,(function (){var or__4212__auto__ = coll;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
return cljs.core.PersistentArrayMap.EMPTY;
}
})());
}));

(compound2.core.t_compound2$core20745.getBasis = (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"opts","opts",1795607228,null),new cljs.core.Symbol(null,"map__20744","map__20744",1897620413,null),new cljs.core.Symbol(null,"id","id",252129435,null),new cljs.core.Symbol(null,"kfn","kfn",729311001,null),new cljs.core.Symbol(null,"meta20746","meta20746",1468440888,null)], null);
}));

(compound2.core.t_compound2$core20745.cljs$lang$type = true);

(compound2.core.t_compound2$core20745.cljs$lang$ctorStr = "compound2.core/t_compound2$core20745");

(compound2.core.t_compound2$core20745.cljs$lang$ctorPrWriter = (function (this__4450__auto__,writer__4451__auto__,opt__4452__auto__){
return cljs.core._write.call(null,writer__4451__auto__,"compound2.core/t_compound2$core20745");
}));

/**
 * Positional factory function for compound2.core/t_compound2$core20745.
 */
compound2.core.__GT_t_compound2$core20745 = (function compound2$core$__GT_t_compound2$core20745(opts__$1,map__20744__$2,id__$2,kfn__$1,meta20746){
return (new compound2.core.t_compound2$core20745(opts__$1,map__20744__$2,id__$2,kfn__$1,meta20746));
});

}

return (new compound2.core.t_compound2$core20745(opts,map__20744__$1,id__$1,kfn,cljs.core.PersistentArrayMap.EMPTY));
}));
compound2.core.dissoc_in = (function compound2$core$dissoc_in(m,p__20748){
var vec__20749 = p__20748;
var seq__20750 = cljs.core.seq.call(null,vec__20749);
var first__20751 = cljs.core.first.call(null,seq__20750);
var seq__20750__$1 = cljs.core.next.call(null,seq__20750);
var k = first__20751;
var ks = seq__20750__$1;
if(ks){
var m2 = compound2.core.dissoc_in.call(null,m.call(null,k),ks);
if(cljs.core.empty_QMARK_.call(null,m2)){
return cljs.core.dissoc.call(null,m,k);
} else {
return cljs.core.assoc.call(null,m,k,m2);
}
} else {
return cljs.core.dissoc.call(null,m,k);
}
});
cljs.core._add_method.call(null,compound2.core.indexer,new cljs.core.Keyword(null,"nested-to-one","nested-to-one",-309923345),(function (opts){
var map__20752 = opts;
var map__20752__$1 = cljs.core.__destructure_map.call(null,map__20752);
var id = cljs.core.get.call(null,map__20752__$1,new cljs.core.Keyword(null,"id","id",-1388402092));
var path = cljs.core.get.call(null,map__20752__$1,new cljs.core.Keyword(null,"path","path",-188191168));
var id__$1 = (function (){var or__4212__auto__ = id;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
if(cljs.core.vector_QMARK_.call(null,path)){
return path;
} else {
return null;
}
}
})();
if((!((id__$1 == null)))){
} else {
throw (new Error(["Assert failed: ","Must provide an id","\n","(some? id)"].join('')));
}

if((typeof compound2 !== 'undefined') && (typeof compound2.core !== 'undefined') && (typeof compound2.core.t_compound2$core20753 !== 'undefined')){
} else {

/**
* @constructor
 * @implements {cljs.core.IMeta}
 * @implements {compound2.core.Index}
 * @implements {cljs.core.IWithMeta}
*/
compound2.core.t_compound2$core20753 = (function (opts,map__20752,id,path,meta20754){
this.opts = opts;
this.map__20752 = map__20752;
this.id = id;
this.path = path;
this.meta20754 = meta20754;
this.cljs$lang$protocol_mask$partition0$ = 393216;
this.cljs$lang$protocol_mask$partition1$ = 0;
});
(compound2.core.t_compound2$core20753.prototype.cljs$core$IWithMeta$_with_meta$arity$2 = (function (_20755,meta20754__$1){
var self__ = this;
var _20755__$1 = this;
return (new compound2.core.t_compound2$core20753(self__.opts,self__.map__20752,self__.id,self__.path,meta20754__$1));
}));

(compound2.core.t_compound2$core20753.prototype.cljs$core$IMeta$_meta$arity$1 = (function (_20755){
var self__ = this;
var _20755__$1 = this;
return self__.meta20754;
}));

(compound2.core.t_compound2$core20753.prototype.compound2$core$Index$ = cljs.core.PROTOCOL_SENTINEL);

(compound2.core.t_compound2$core20753.prototype.compound2$core$Index$id$arity$1 = (function (this$){
var self__ = this;
var this$__$1 = this;
return self__.id;
}));

(compound2.core.t_compound2$core20753.prototype.compound2$core$Index$extract_key$arity$2 = (function (this$,x){
var self__ = this;
var this$__$1 = this;
return cljs.core.into.call(null,cljs.core.PersistentVector.EMPTY,(function (){var iter__4611__auto__ = (function compound2$core$iter__20756(s__20757){
return (new cljs.core.LazySeq(null,(function (){
var s__20757__$1 = s__20757;
while(true){
var temp__5753__auto__ = cljs.core.seq.call(null,s__20757__$1);
if(temp__5753__auto__){
var s__20757__$2 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_.call(null,s__20757__$2)){
var c__4609__auto__ = cljs.core.chunk_first.call(null,s__20757__$2);
var size__4610__auto__ = cljs.core.count.call(null,c__4609__auto__);
var b__20759 = cljs.core.chunk_buffer.call(null,size__4610__auto__);
if((function (){var i__20758 = (0);
while(true){
if((i__20758 < size__4610__auto__)){
var p = cljs.core._nth.call(null,c__4609__auto__,i__20758);
cljs.core.chunk_append.call(null,b__20759,p.call(null,x));

var G__20760 = (i__20758 + (1));
i__20758 = G__20760;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__20759),compound2$core$iter__20756.call(null,cljs.core.chunk_rest.call(null,s__20757__$2)));
} else {
return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__20759),null);
}
} else {
var p = cljs.core.first.call(null,s__20757__$2);
return cljs.core.cons.call(null,p.call(null,x),compound2$core$iter__20756.call(null,cljs.core.rest.call(null,s__20757__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__4611__auto__.call(null,self__.path);
})());
}));

(compound2.core.t_compound2$core20753.prototype.compound2$core$Index$index$arity$4 = (function (this$,coll,ks,x){
var self__ = this;
var this$__$1 = this;
return cljs.core.assoc_in.call(null,coll,ks,x);
}));

(compound2.core.t_compound2$core20753.prototype.compound2$core$Index$unindex$arity$4 = (function (this$,coll,ks,x){
var self__ = this;
var this$__$1 = this;
return compound2.core.dissoc_in.call(null,coll,ks);
}));

(compound2.core.t_compound2$core20753.prototype.compound2$core$Index$after$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
return coll;
}));

(compound2.core.t_compound2$core20753.prototype.compound2$core$Index$before$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
var or__4212__auto__ = coll;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
return cljs.core.PersistentArrayMap.EMPTY;
}
}));

(compound2.core.t_compound2$core20753.getBasis = (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"opts","opts",1795607228,null),new cljs.core.Symbol(null,"map__20752","map__20752",-1855661389,null),new cljs.core.Symbol(null,"id","id",252129435,null),new cljs.core.Symbol(null,"path","path",1452340359,null),new cljs.core.Symbol(null,"meta20754","meta20754",-1693739453,null)], null);
}));

(compound2.core.t_compound2$core20753.cljs$lang$type = true);

(compound2.core.t_compound2$core20753.cljs$lang$ctorStr = "compound2.core/t_compound2$core20753");

(compound2.core.t_compound2$core20753.cljs$lang$ctorPrWriter = (function (this__4450__auto__,writer__4451__auto__,opt__4452__auto__){
return cljs.core._write.call(null,writer__4451__auto__,"compound2.core/t_compound2$core20753");
}));

/**
 * Positional factory function for compound2.core/t_compound2$core20753.
 */
compound2.core.__GT_t_compound2$core20753 = (function compound2$core$__GT_t_compound2$core20753(opts__$1,map__20752__$2,id__$2,path__$1,meta20754){
return (new compound2.core.t_compound2$core20753(opts__$1,map__20752__$2,id__$2,path__$1,meta20754));
});

}

return (new compound2.core.t_compound2$core20753(opts,map__20752__$1,id__$1,path,cljs.core.PersistentArrayMap.EMPTY));
}));
cljs.core._add_method.call(null,compound2.core.indexer,new cljs.core.Keyword(null,"nested-to-many","nested-to-many",-12665000),(function (opts){
var map__20761 = opts;
var map__20761__$1 = cljs.core.__destructure_map.call(null,map__20761);
var id = cljs.core.get.call(null,map__20761__$1,new cljs.core.Keyword(null,"id","id",-1388402092));
var path = cljs.core.get.call(null,map__20761__$1,new cljs.core.Keyword(null,"path","path",-188191168));
var id__$1 = (function (){var or__4212__auto__ = id;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
if(cljs.core.vector_QMARK_.call(null,path)){
return path;
} else {
return null;
}
}
})();
if((!((id__$1 == null)))){
} else {
throw (new Error(["Assert failed: ","Must provide an id","\n","(some? id)"].join('')));
}

if((typeof compound2 !== 'undefined') && (typeof compound2.core !== 'undefined') && (typeof compound2.core.t_compound2$core20762 !== 'undefined')){
} else {

/**
* @constructor
 * @implements {cljs.core.IMeta}
 * @implements {compound2.core.Index}
 * @implements {cljs.core.IWithMeta}
*/
compound2.core.t_compound2$core20762 = (function (opts,map__20761,id,path,meta20763){
this.opts = opts;
this.map__20761 = map__20761;
this.id = id;
this.path = path;
this.meta20763 = meta20763;
this.cljs$lang$protocol_mask$partition0$ = 393216;
this.cljs$lang$protocol_mask$partition1$ = 0;
});
(compound2.core.t_compound2$core20762.prototype.cljs$core$IWithMeta$_with_meta$arity$2 = (function (_20764,meta20763__$1){
var self__ = this;
var _20764__$1 = this;
return (new compound2.core.t_compound2$core20762(self__.opts,self__.map__20761,self__.id,self__.path,meta20763__$1));
}));

(compound2.core.t_compound2$core20762.prototype.cljs$core$IMeta$_meta$arity$1 = (function (_20764){
var self__ = this;
var _20764__$1 = this;
return self__.meta20763;
}));

(compound2.core.t_compound2$core20762.prototype.compound2$core$Index$ = cljs.core.PROTOCOL_SENTINEL);

(compound2.core.t_compound2$core20762.prototype.compound2$core$Index$id$arity$1 = (function (this$){
var self__ = this;
var this$__$1 = this;
return self__.id;
}));

(compound2.core.t_compound2$core20762.prototype.compound2$core$Index$extract_key$arity$2 = (function (this$,x){
var self__ = this;
var this$__$1 = this;
return cljs.core.into.call(null,cljs.core.PersistentVector.EMPTY,(function (){var iter__4611__auto__ = (function compound2$core$iter__20765(s__20766){
return (new cljs.core.LazySeq(null,(function (){
var s__20766__$1 = s__20766;
while(true){
var temp__5753__auto__ = cljs.core.seq.call(null,s__20766__$1);
if(temp__5753__auto__){
var s__20766__$2 = temp__5753__auto__;
if(cljs.core.chunked_seq_QMARK_.call(null,s__20766__$2)){
var c__4609__auto__ = cljs.core.chunk_first.call(null,s__20766__$2);
var size__4610__auto__ = cljs.core.count.call(null,c__4609__auto__);
var b__20768 = cljs.core.chunk_buffer.call(null,size__4610__auto__);
if((function (){var i__20767 = (0);
while(true){
if((i__20767 < size__4610__auto__)){
var p = cljs.core._nth.call(null,c__4609__auto__,i__20767);
cljs.core.chunk_append.call(null,b__20768,p.call(null,x));

var G__20769 = (i__20767 + (1));
i__20767 = G__20769;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__20768),compound2$core$iter__20765.call(null,cljs.core.chunk_rest.call(null,s__20766__$2)));
} else {
return cljs.core.chunk_cons.call(null,cljs.core.chunk.call(null,b__20768),null);
}
} else {
var p = cljs.core.first.call(null,s__20766__$2);
return cljs.core.cons.call(null,p.call(null,x),compound2$core$iter__20765.call(null,cljs.core.rest.call(null,s__20766__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__4611__auto__.call(null,self__.path);
})());
}));

(compound2.core.t_compound2$core20762.prototype.compound2$core$Index$index$arity$4 = (function (this$,coll,ks,x){
var self__ = this;
var this$__$1 = this;
return cljs.core.update_in.call(null,coll,ks,cljs.core.fnil.call(null,cljs.core.conj,cljs.core.PersistentHashSet.EMPTY),x);
}));

(compound2.core.t_compound2$core20762.prototype.compound2$core$Index$unindex$arity$4 = (function (this$,coll,ks,x){
var self__ = this;
var this$__$1 = this;
var ex = cljs.core.get_in.call(null,coll,ks);
var new$ = cljs.core.disj.call(null,ex,x);
if(cljs.core.seq.call(null,new$)){
return cljs.core.assoc_in.call(null,coll,ks,new$);
} else {
return compound2.core.dissoc_in.call(null,coll,ks);
}
}));

(compound2.core.t_compound2$core20762.prototype.compound2$core$Index$after$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
return coll;
}));

(compound2.core.t_compound2$core20762.prototype.compound2$core$Index$before$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
var or__4212__auto__ = coll;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
return cljs.core.PersistentArrayMap.EMPTY;
}
}));

(compound2.core.t_compound2$core20762.getBasis = (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"opts","opts",1795607228,null),new cljs.core.Symbol(null,"map__20761","map__20761",1808811238,null),new cljs.core.Symbol(null,"id","id",252129435,null),new cljs.core.Symbol(null,"path","path",1452340359,null),new cljs.core.Symbol(null,"meta20763","meta20763",1037651465,null)], null);
}));

(compound2.core.t_compound2$core20762.cljs$lang$type = true);

(compound2.core.t_compound2$core20762.cljs$lang$ctorStr = "compound2.core/t_compound2$core20762");

(compound2.core.t_compound2$core20762.cljs$lang$ctorPrWriter = (function (this__4450__auto__,writer__4451__auto__,opt__4452__auto__){
return cljs.core._write.call(null,writer__4451__auto__,"compound2.core/t_compound2$core20762");
}));

/**
 * Positional factory function for compound2.core/t_compound2$core20762.
 */
compound2.core.__GT_t_compound2$core20762 = (function compound2$core$__GT_t_compound2$core20762(opts__$1,map__20761__$2,id__$2,path__$1,meta20763){
return (new compound2.core.t_compound2$core20762(opts__$1,map__20761__$2,id__$2,path__$1,meta20763));
});

}

return (new compound2.core.t_compound2$core20762(opts,map__20761__$1,id__$1,path,cljs.core.PersistentArrayMap.EMPTY));
}));
cljs.core._add_method.call(null,compound2.core.indexer,new cljs.core.Keyword(null,"many-to-many","many-to-many",2123573002),(function (opts){
var map__20770 = opts;
var map__20770__$1 = cljs.core.__destructure_map.call(null,map__20770);
var id = cljs.core.get.call(null,map__20770__$1,new cljs.core.Keyword(null,"id","id",-1388402092));
var kfn = cljs.core.get.call(null,map__20770__$1,new cljs.core.Keyword(null,"kfn","kfn",-911220526));
var id__$1 = (function (){var or__4212__auto__ = id;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
if((kfn instanceof cljs.core.Keyword)){
return kfn;
} else {
return null;
}
}
})();
if((!((id__$1 == null)))){
} else {
throw (new Error(["Assert failed: ","Must provide an id","\n","(some? id)"].join('')));
}

if((typeof compound2 !== 'undefined') && (typeof compound2.core !== 'undefined') && (typeof compound2.core.t_compound2$core20771 !== 'undefined')){
} else {

/**
* @constructor
 * @implements {cljs.core.IMeta}
 * @implements {compound2.core.Index}
 * @implements {cljs.core.IWithMeta}
*/
compound2.core.t_compound2$core20771 = (function (opts,map__20770,id,kfn,meta20772){
this.opts = opts;
this.map__20770 = map__20770;
this.id = id;
this.kfn = kfn;
this.meta20772 = meta20772;
this.cljs$lang$protocol_mask$partition0$ = 393216;
this.cljs$lang$protocol_mask$partition1$ = 0;
});
(compound2.core.t_compound2$core20771.prototype.cljs$core$IWithMeta$_with_meta$arity$2 = (function (_20773,meta20772__$1){
var self__ = this;
var _20773__$1 = this;
return (new compound2.core.t_compound2$core20771(self__.opts,self__.map__20770,self__.id,self__.kfn,meta20772__$1));
}));

(compound2.core.t_compound2$core20771.prototype.cljs$core$IMeta$_meta$arity$1 = (function (_20773){
var self__ = this;
var _20773__$1 = this;
return self__.meta20772;
}));

(compound2.core.t_compound2$core20771.prototype.compound2$core$Index$ = cljs.core.PROTOCOL_SENTINEL);

(compound2.core.t_compound2$core20771.prototype.compound2$core$Index$id$arity$1 = (function (this$){
var self__ = this;
var this$__$1 = this;
return self__.id;
}));

(compound2.core.t_compound2$core20771.prototype.compound2$core$Index$extract_key$arity$2 = (function (this$,x){
var self__ = this;
var this$__$1 = this;
return self__.kfn.call(null,x);
}));

(compound2.core.t_compound2$core20771.prototype.compound2$core$Index$index$arity$4 = (function (this$,coll,ks,x){
var self__ = this;
var this$__$1 = this;
return cljs.core.reduce.call(null,(function (acc,k){
return cljs.core.update.call(null,acc,k,cljs.core.fnil.call(null,cljs.core.conj,cljs.core.PersistentHashSet.EMPTY),x);
}),coll,ks);
}));

(compound2.core.t_compound2$core20771.prototype.compound2$core$Index$unindex$arity$4 = (function (this$,coll,ks,x){
var self__ = this;
var this$__$1 = this;
return cljs.core.reduce.call(null,(function (acc,k){
return cljs.core.update.call(null,acc,k,cljs.core.disj,x);
}),coll,ks);
}));

(compound2.core.t_compound2$core20771.prototype.compound2$core$Index$after$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
return coll;
}));

(compound2.core.t_compound2$core20771.prototype.compound2$core$Index$before$arity$2 = (function (this$,coll){
var self__ = this;
var this$__$1 = this;
var or__4212__auto__ = coll;
if(cljs.core.truth_(or__4212__auto__)){
return or__4212__auto__;
} else {
return cljs.core.PersistentArrayMap.EMPTY;
}
}));

(compound2.core.t_compound2$core20771.getBasis = (function (){
return new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Symbol(null,"opts","opts",1795607228,null),new cljs.core.Symbol(null,"map__20770","map__20770",-1987314095,null),new cljs.core.Symbol(null,"id","id",252129435,null),new cljs.core.Symbol(null,"kfn","kfn",729311001,null),new cljs.core.Symbol(null,"meta20772","meta20772",2019923921,null)], null);
}));

(compound2.core.t_compound2$core20771.cljs$lang$type = true);

(compound2.core.t_compound2$core20771.cljs$lang$ctorStr = "compound2.core/t_compound2$core20771");

(compound2.core.t_compound2$core20771.cljs$lang$ctorPrWriter = (function (this__4450__auto__,writer__4451__auto__,opt__4452__auto__){
return cljs.core._write.call(null,writer__4451__auto__,"compound2.core/t_compound2$core20771");
}));

/**
 * Positional factory function for compound2.core/t_compound2$core20771.
 */
compound2.core.__GT_t_compound2$core20771 = (function compound2$core$__GT_t_compound2$core20771(opts__$1,map__20770__$2,id__$2,kfn__$1,meta20772){
return (new compound2.core.t_compound2$core20771(opts__$1,map__20770__$2,id__$2,kfn__$1,meta20772));
});

}

return (new compound2.core.t_compound2$core20771(opts,map__20770__$1,id__$1,kfn,cljs.core.PersistentArrayMap.EMPTY));
}));
compound2.core.primary_defaults = new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"index-type","index-type",500383962),new cljs.core.Keyword(null,"one-to-one","one-to-one",-984522312)], null);
compound2.core.secondary_defaults = new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"index-type","index-type",500383962),new cljs.core.Keyword(null,"one-to-many","one-to-many",-524686670)], null);
compound2.core.compound_STAR_ = (function compound2$core$compound_STAR_(indexes){
var pi = compound2.core.indexer.call(null,cljs.core.merge.call(null,compound2.core.primary_defaults,cljs.core.first.call(null,indexes)));
var sis = cljs.core.map.call(null,(function (opts){
return compound2.core.indexer.call(null,cljs.core.merge.call(null,compound2.core.secondary_defaults,opts));
}),cljs.core.rest.call(null,indexes));
if((((!((pi == null))))?((((false) || ((cljs.core.PROTOCOL_SENTINEL === pi.compound2$core$PrimaryIndex$))))?true:(((!pi.cljs$lang$protocol_mask$partition$))?cljs.core.native_satisfies_QMARK_.call(null,compound2.core.PrimaryIndex,pi):false)):cljs.core.native_satisfies_QMARK_.call(null,compound2.core.PrimaryIndex,pi))){
} else {
throw (new Error(["Assert failed: ","First index must be a primary index","\n","(satisfies? PrimaryIndex pi)"].join('')));
}

return cljs.core.with_meta.call(null,cljs.core.PersistentArrayMap.EMPTY,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Symbol("compound2.core","items","compound2.core/items",493606175,null),(function (c){
return compound2.core.get_all.call(null,pi,cljs.core.get.call(null,c,compound2.core.id.call(null,pi)));
}),new cljs.core.Symbol("compound2.core","add-items","compound2.core/add-items",-1582321840,null),(function (c,xs){
var px = compound2.core.before.call(null,pi,cljs.core.get.call(null,c,compound2.core.id.call(null,pi)));
var sixs = cljs.core.reduce.call(null,(function (acc,si){
return cljs.core.assoc.call(null,acc,si,compound2.core.before.call(null,si,cljs.core.get.call(null,c,compound2.core.id.call(null,si))));
}),cljs.core.PersistentArrayMap.EMPTY,sis);
var G__20778 = xs;
var vec__20779 = G__20778;
var seq__20780 = cljs.core.seq.call(null,vec__20779);
var first__20781 = cljs.core.first.call(null,seq__20780);
var seq__20780__$1 = cljs.core.next.call(null,seq__20780);
var x = first__20781;
var more = seq__20780__$1;
var xs__$1 = vec__20779;
var px__$1 = px;
var sixs__$1 = sixs;
var G__20778__$1 = G__20778;
while(true){
var px__$2 = px__$1;
var sixs__$2 = sixs__$1;
var vec__20785 = G__20778__$1;
var seq__20786 = cljs.core.seq.call(null,vec__20785);
var first__20787 = cljs.core.first.call(null,seq__20786);
var seq__20786__$1 = cljs.core.next.call(null,seq__20786);
var x__$1 = first__20787;
var more__$1 = seq__20786__$1;
var xs__$2 = vec__20785;
if(cljs.core.seq.call(null,xs__$2)){
var k = compound2.core.extract_key.call(null,pi,x__$1);
var ex = compound2.core.get_by_key.call(null,pi,px__$2,k);
if(cljs.core.truth_(ex)){
var new$ = compound2.core.on_conflict.call(null,pi,ex,x__$1);
var G__20801 = compound2.core.index.call(null,pi,px__$2,k,new$);
var G__20802 = cljs.core.reduce_kv.call(null,((function (px__$1,sixs__$1,G__20778__$1,new$,k,ex,px__$2,sixs__$2,vec__20785,seq__20786,first__20787,seq__20786__$1,x__$1,more__$1,xs__$2,px,sixs,G__20778,vec__20779,seq__20780,first__20781,seq__20780__$1,x,more,xs__$1,pi,sis){
return (function (acc,si,sx){
return cljs.core.assoc.call(null,acc,si,(function (){var k1 = compound2.core.extract_key.call(null,si,ex);
var k2 = compound2.core.extract_key.call(null,si,new$);
return compound2.core.index.call(null,si,compound2.core.unindex.call(null,si,sx,k1,ex),k2,new$);
})());
});})(px__$1,sixs__$1,G__20778__$1,new$,k,ex,px__$2,sixs__$2,vec__20785,seq__20786,first__20787,seq__20786__$1,x__$1,more__$1,xs__$2,px,sixs,G__20778,vec__20779,seq__20780,first__20781,seq__20780__$1,x,more,xs__$1,pi,sis))
,cljs.core.PersistentArrayMap.EMPTY,sixs__$2);
var G__20803 = more__$1;
px__$1 = G__20801;
sixs__$1 = G__20802;
G__20778__$1 = G__20803;
continue;
} else {
var G__20804 = compound2.core.index.call(null,pi,px__$2,k,x__$1);
var G__20805 = cljs.core.reduce_kv.call(null,((function (px__$1,sixs__$1,G__20778__$1,k,ex,px__$2,sixs__$2,vec__20785,seq__20786,first__20787,seq__20786__$1,x__$1,more__$1,xs__$2,px,sixs,G__20778,vec__20779,seq__20780,first__20781,seq__20780__$1,x,more,xs__$1,pi,sis){
return (function (acc,si,sx){
return cljs.core.assoc.call(null,acc,si,(function (){var k__$1 = compound2.core.extract_key.call(null,si,x__$1);
return compound2.core.index.call(null,si,sx,k__$1,x__$1);
})());
});})(px__$1,sixs__$1,G__20778__$1,k,ex,px__$2,sixs__$2,vec__20785,seq__20786,first__20787,seq__20786__$1,x__$1,more__$1,xs__$2,px,sixs,G__20778,vec__20779,seq__20780,first__20781,seq__20780__$1,x,more,xs__$1,pi,sis))
,cljs.core.PersistentArrayMap.EMPTY,sixs__$2);
var G__20806 = more__$1;
px__$1 = G__20804;
sixs__$1 = G__20805;
G__20778__$1 = G__20806;
continue;
}
} else {
return cljs.core.with_meta.call(null,cljs.core.reduce_kv.call(null,((function (px__$1,sixs__$1,G__20778__$1,px__$2,sixs__$2,vec__20785,seq__20786,first__20787,seq__20786__$1,x__$1,more__$1,xs__$2,px,sixs,G__20778,vec__20779,seq__20780,first__20781,seq__20780__$1,x,more,xs__$1,pi,sis){
return (function (acc,si,sx){
return cljs.core.assoc.call(null,acc,compound2.core.id.call(null,si),compound2.core.after.call(null,si,sx));
});})(px__$1,sixs__$1,G__20778__$1,px__$2,sixs__$2,vec__20785,seq__20786,first__20787,seq__20786__$1,x__$1,more__$1,xs__$2,px,sixs,G__20778,vec__20779,seq__20780,first__20781,seq__20780__$1,x,more,xs__$1,pi,sis))
,cljs.core.PersistentArrayMap.createAsIfByAssoc([compound2.core.id.call(null,pi),compound2.core.after.call(null,pi,px__$2)]),sixs__$2),cljs.core.meta.call(null,c));
}
break;
}
}),new cljs.core.Symbol("compound2.core","remove-keys","compound2.core/remove-keys",-384447827,null),(function (c,ks){
var px = compound2.core.before.call(null,pi,cljs.core.get.call(null,c,compound2.core.id.call(null,pi)));
var sixs = cljs.core.reduce.call(null,(function (acc,si){
return cljs.core.assoc.call(null,acc,si,compound2.core.before.call(null,si,cljs.core.get.call(null,c,compound2.core.id.call(null,si))));
}),cljs.core.PersistentArrayMap.EMPTY,sis);
var G__20791 = ks;
var vec__20792 = G__20791;
var seq__20793 = cljs.core.seq.call(null,vec__20792);
var first__20794 = cljs.core.first.call(null,seq__20793);
var seq__20793__$1 = cljs.core.next.call(null,seq__20793);
var k = first__20794;
var more = seq__20793__$1;
var ks__$1 = vec__20792;
var px__$1 = px;
var sixs__$1 = sixs;
var G__20791__$1 = G__20791;
while(true){
var px__$2 = px__$1;
var sixs__$2 = sixs__$1;
var vec__20798 = G__20791__$1;
var seq__20799 = cljs.core.seq.call(null,vec__20798);
var first__20800 = cljs.core.first.call(null,seq__20799);
var seq__20799__$1 = cljs.core.next.call(null,seq__20799);
var k__$1 = first__20800;
var more__$1 = seq__20799__$1;
var ks__$2 = vec__20798;
if(cljs.core.seq.call(null,ks__$2)){
var temp__5751__auto__ = compound2.core.get_by_key.call(null,pi,px__$2,k__$1);
if(cljs.core.truth_(temp__5751__auto__)){
var ex = temp__5751__auto__;
var G__20807 = compound2.core.unindex.call(null,pi,px__$2,k__$1,ex);
var G__20808 = cljs.core.reduce_kv.call(null,((function (px__$1,sixs__$1,G__20791__$1,ex,temp__5751__auto__,px__$2,sixs__$2,vec__20798,seq__20799,first__20800,seq__20799__$1,k__$1,more__$1,ks__$2,px,sixs,G__20791,vec__20792,seq__20793,first__20794,seq__20793__$1,k,more,ks__$1,pi,sis){
return (function (acc,si,sx){
return cljs.core.assoc.call(null,acc,si,(function (){var k__$2 = compound2.core.extract_key.call(null,si,ex);
return compound2.core.unindex.call(null,si,sx,k__$2,ex);
})());
});})(px__$1,sixs__$1,G__20791__$1,ex,temp__5751__auto__,px__$2,sixs__$2,vec__20798,seq__20799,first__20800,seq__20799__$1,k__$1,more__$1,ks__$2,px,sixs,G__20791,vec__20792,seq__20793,first__20794,seq__20793__$1,k,more,ks__$1,pi,sis))
,cljs.core.PersistentArrayMap.EMPTY,sixs__$2);
var G__20809 = more__$1;
px__$1 = G__20807;
sixs__$1 = G__20808;
G__20791__$1 = G__20809;
continue;
} else {
var G__20810 = px__$2;
var G__20811 = sixs__$2;
var G__20812 = more__$1;
px__$1 = G__20810;
sixs__$1 = G__20811;
G__20791__$1 = G__20812;
continue;
}
} else {
return cljs.core.with_meta.call(null,cljs.core.reduce_kv.call(null,((function (px__$1,sixs__$1,G__20791__$1,px__$2,sixs__$2,vec__20798,seq__20799,first__20800,seq__20799__$1,k__$1,more__$1,ks__$2,px,sixs,G__20791,vec__20792,seq__20793,first__20794,seq__20793__$1,k,more,ks__$1,pi,sis){
return (function (acc,si,sx){
return cljs.core.assoc.call(null,acc,compound2.core.id.call(null,si),compound2.core.after.call(null,si,sx));
});})(px__$1,sixs__$1,G__20791__$1,px__$2,sixs__$2,vec__20798,seq__20799,first__20800,seq__20799__$1,k__$1,more__$1,ks__$2,px,sixs,G__20791,vec__20792,seq__20793,first__20794,seq__20793__$1,k,more,ks__$1,pi,sis))
,cljs.core.PersistentArrayMap.createAsIfByAssoc([compound2.core.id.call(null,pi),compound2.core.after.call(null,pi,px__$2)]),sixs__$2),cljs.core.meta.call(null,c));
}
break;
}
})], null));
});

//# sourceMappingURL=core.js.map
